-- TODO: Fix Timezone
DROP TABLE IF EXISTS tbl_cfg_fund_config;
CREATE TABLE tbl_cfg_fund_config (
    "FUND NAME" TEXT NOT NULL,
    "EFFECTIVE START DATE" DATE NOT NULL,
    "EFFECTIVE END DATE" DATE NOT NULL,
    "LAST UPDATE DATE" TIMESTAMP DEFAULT CURRENT_TIMESTAMP,
    "LAST UPDATE USER" TEXT DEFAULT 'BATCH',
    PRIMARY KEY ("FUND NAME", "EFFECTIVE START DATE")
);

-- Insert current interested funds as active from start of 2025 to 9998-12-31
INSERT INTO tbl_cfg_fund_config ("FUND NAME", "EFFECTIVE START DATE", "EFFECTIVE END DATE") VALUES
('Whitestone', '2025-01-01', '9998-12-31'),
('Wallington', '2025-01-01', '9998-12-31'),
('Catalysm', '2025-01-01', '9998-12-31'),
('Belaware', '2025-01-01', '9998-12-31'),
('Gohen', '2025-01-01', '9998-12-31'),
('Applebead', '2025-01-01', '9998-12-31'),
('Magnum', '2025-01-01', '9998-12-31'),
('Trustmind', '2025-01-01', '9998-12-31'),
('Leeder', '2025-01-01', '9998-12-31');

DROP TABLE IF EXISTS tbl_raw_fund_position_details;
CREATE TABLE IF NOT EXISTS tbl_raw_fund_position_details (
    "DATETIME" DATE,
    "FUND NAME" TEXT,
    "FINANCIAL TYPE" TEXT,
    "SYMBOL" TEXT,
    "SECURITY NAME" TEXT,
    "SEDOL" TEXT,
    "ISIN" TEXT,
    "PRICE" REAL,
    "QUANTITY" REAL,
    "REALISED P/L" REAL,
    "MARKET VALUE" REAL,
    "LAST UPDATE DATE" TIMESTAMP DEFAULT CURRENT_TIMESTAMP,
    "LAST UPDATE USER" TEXT DEFAULT 'BATCH'
);

DROP TABLE IF EXISTS tbl_stg_fund_position_details;
CREATE TABLE IF NOT EXISTS tbl_stg_fund_position_details (
    "DATETIME"	DATE,
    "FUND NAME" TEXT,
    "FINANCIAL TYPE" TEXT,
    "SYMBOL" TEXT,
    "SECURITY NAME" TEXT,
    "SEDOL" TEXT,
    "ISIN" TEXT,
    "PRICE" REAL,
    "QUANTITY" REAL,
    "REALISED P/L" REAL,
    "MARKET VALUE" REAL,
    "LAST UPDATE DATE" TIMESTAMP DEFAULT CURRENT_TIMESTAMP,
    "LAST UPDATE USER" TEXT DEFAULT 'BATCH'
);

DROP TABLE IF EXISTS tbl_pub_fund_position_details;
CREATE TABLE IF NOT EXISTS tbl_pub_fund_position_details (
    "DATETIME"	DATE,
    "FUND NAME" TEXT,
    "FINANCIAL TYPE" TEXT,
    "SYMBOL" TEXT,
    "SECURITY NAME" TEXT,
    "SEDOL" TEXT,
    "ISIN" TEXT,
    "PRICE" REAL,
    "QUANTITY" REAL,
    "REALISED P/L" REAL,
    "MARKET VALUE" REAL,
    "LAST UPDATE DATE" TIMESTAMP DEFAULT CURRENT_TIMESTAMP,
    "LAST UPDATE USER" TEXT DEFAULT 'BATCH'
);


DROP TABLE IF EXISTS tbl_stg_equity_reference;
CREATE TABLE IF NOT EXISTS "tbl_stg_equity_reference" (
	"SYMBOL"	TEXT,
	"COUNTRY"	TEXT,
	"SECURITY NAME"	TEXT,
	"SECTOR"	TEXT,
	"INDUSTRY"	TEXT,
	"CURRENCY"	TEXT,
    "LAST UPDATE DATE" TIMESTAMP DEFAULT CURRENT_TIMESTAMP,
    "LAST UPDATE USER" TEXT DEFAULT 'BATCH'
);

DROP TABLE IF EXISTS tbl_stg_equity_prices;
CREATE TABLE IF NOT EXISTS "tbl_stg_equity_prices" (
	"DATETIME"	DATE,
	"SYMBOL"	TEXT,
	"PRICE"	REAL,
    "LAST UPDATE DATE" TIMESTAMP DEFAULT CURRENT_TIMESTAMP,
    "LAST UPDATE USER" TEXT DEFAULT 'BATCH'
);

DROP TABLE IF EXISTS tbl_pub_equity_reference;
CREATE TABLE IF NOT EXISTS "tbl_pub_equity_reference" (
	"SYMBOL"	TEXT,
	"COUNTRY"	TEXT,
	"SECURITY NAME"	TEXT,
	"SECTOR"	TEXT,
	"INDUSTRY"	TEXT,
	"CURRENCY"	TEXT,
    "LAST UPDATE DATE" TIMESTAMP DEFAULT CURRENT_TIMESTAMP,
    "LAST UPDATE USER" TEXT DEFAULT 'BATCH'
);

DROP TABLE IF EXISTS tbl_pub_equity_prices;
CREATE TABLE IF NOT EXISTS "tbl_pub_equity_prices" (
	"DATETIME"	DATE,
	"SYMBOL"	TEXT,
	"PRICE"	REAL,
    "LAST UPDATE DATE" TIMESTAMP DEFAULT CURRENT_TIMESTAMP,
    "LAST UPDATE USER" TEXT DEFAULT 'BATCH'
);